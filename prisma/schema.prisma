generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator json {
  provider = "prisma-json-types-generator"
}

generator prismabox {
  provider                    = "prismabox"
  typeboxImportDependencyName = "elysia"
  typeboxImportVariableName   = "t"
  inputModel                  = true
}

model User {
  id        String  @id @default(uuid())
  name      String
  email     String  @unique
  password  String
  avatarUrl String?

  role        UserRole @default(User)
  
  organization   Organization? @relation(fields: [organizationId], references: [id])
  organizationId String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum UserRole {
  Admin
  User
}

model Organization {
  id          String  @id @default(uuid())
  
  /// [LocalString]
  name        Json
  /// [LocalString]
  description Json?
  phoneNumber String?
  email       String?
  
  googleMapsLink String?
  /// [SocialMediaLink]
  socialMedia   Json[]

  slug        String  @unique
  logoImgUrl  String?

  users      User[]
  categories Category[]
  items      Item[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Category {
  id             String  @id @default(uuid())
  slug           String  @unique
  /// [LocalString]
  name           Json
  imageUrl       String?
  
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  organizationId String
  
  items          Item[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Item {
  id          String @id @default(uuid())
  slug        String @unique

  /// [LocalString]
  name        Json
  /// [LocalString]
  description Json?

  imageUrl    String[]
  basePrice   String

  /// [ItemVariantGroup]
  variantGroups Json?
  
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  organizationId String
  
  category       Category? @relation(fields: [categoryId], references: [id])
  categoryId     String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}